CREATE OR ALTER VIEW Construction_licence
AS
SELECT
    REG,
    DEP,
    COMM,
    Type_DAU,
    Num_DAU,
    Etat_DAU,
    DATE_REELLE_AUTORISATION,
    DATE_REELLE_DOC,
    DATE_REELLE_DAACT,
    SUPERFICIE_TERRAIN,
    NB_LGT_TOT_CREES,
    NB_LGT_IND_CREES,
    NB_LGT_COL_CREES,
    SURF_HAB_CREEE
FROM
    OPENROWSET(
        BULK 'construction/*.csv',
        DATA_SOURCE = 'licence',
        FORMAT = 'CSV',
        FIELDTERMINATOR = ';',
        FIRSTROW = 2,
        CODEPAGE = 'RAW'
    )
    WITH (
        REG VARCHAR(10),
        DEP VARCHAR(10),
        COMM VARCHAR(10),
        Type_DAU VARCHAR(255),
        Num_DAU VARCHAR(255),
        Etat_DAU VARCHAR(255),
        DATE_REELLE_AUTORISATION DATE,
        DATE_REELLE_DOC DATE,
        DATE_REELLE_DAACT DATE,
        AN_DEPOT INT,
        DPC_PREM VARCHAR(255),
        DPC_AUT VARCHAR(255),
        DPC_DOC VARCHAR(255),
        DPC_DERN VARCHAR(255),
        CAT_DEM VARCHAR(255),
        APE_DEM VARCHAR(255),
        CJ_DEM VARCHAR(255),
        DENOM_DEM VARCHAR(255),
        SIREN_DEM VARCHAR(255),
        SIRET_DEM VARCHAR(255),
        CODPOST_DEM VARCHAR(255),
        LOCALITE_DEM VARCHAR(255),
        REC_ARCHI VARCHAR(255),
        ADR_NUM_TER VARCHAR(255),
        ADR_TYPEVOIE_TER VARCHAR(255),
        ADR_LIBVOIE_TER VARCHAR(255),
        ADR_LIEUDIT_TER VARCHAR(255),
        ADR_LOCALITE_TER VARCHAR(255),
        ADR_CODPOST_TER VARCHAR(255),
        sec_cadastre1 VARCHAR(255),
        num_cadastre1 VARCHAR(255),
        sec_cadastre2 VARCHAR(255),
        num_cadastre2 VARCHAR(255),
        sec_cadastre3 VARCHAR(255),
        num_cadastre3 VARCHAR(255),
        SUPERFICIE_TERRAIN BIGINT,
        ZONE_OP VARCHAR(255),
        NATURE_PROJET_DECLAREE VARCHAR(255),
        NATURE_PROJET_COMPLETEE VARCHAR(255),
        DESTINATION_PRINCIPALE VARCHAR(255),
        TYPE_PRINCIP_LOGTS_CREES VARCHAR(255),
        TYPE_TRANSFO_PRINCIPAL VARCHAR(255),
        TYPE_PRINCIP_LOCAUX_TRANSFORMES VARCHAR(255),
        I_EXTENSION VARCHAR(255),
        I_SURELEVATION VARCHAR(255),
        I_NIVSUPP VARCHAR(255),
        NB_NIV_MAX VARCHAR(255),
        UTILISATION VARCHAR(255),
        RES_PRINCIP_OU_SECOND VARCHAR(255),
        TYP_ANNEXE VARCHAR(255),
        I_PISCINE VARCHAR(255),
        I_GARAGE VARCHAR(255),
        I_VERANDA VARCHAR(255),
        I_ABRI_JARDIN VARCHAR(255),
        I_AUTRE_ANNEXE VARCHAR(255),
        RESIDENCE VARCHAR(255),
        RES_PERS_AGEES VARCHAR(255),
        RES_ETUDIANTS VARCHAR(255),
        RES_TOURISME VARCHAR(255),
        RES_HOTEL_SOCIALE VARCHAR(255),
        RES_SOCIALE VARCHAR(255),
        RES_HANDICAPES VARCHAR(255),
        RES_AUTRE VARCHAR(255),
        NB_LGT_TOT_CREES INT,
        NB_LGT_IND_CREES INT,
        NB_LGT_COL_CREES INT,
        NB_LGT_INDIV_PURS VARCHAR(255),
        NB_LGT_INDIV_GROUPES VARCHAR(255),
        NB_LGT_RES VARCHAR(255),
        NB_LGT_COL_HORS_RES VARCHAR(255),
        NB_LGT_DEMOLIS VARCHAR(255),
        NB_LGT_1P VARCHAR(255),
        NB_LGT_2P VARCHAR(255),
        NB_LGT_3P VARCHAR(255),
        NB_LGT_4P VARCHAR(255),
        NB_LGT_5P VARCHAR(255),
        NB_LGT_6P_PLUS VARCHAR(255),
        NB_LGT_PRET_LOC_SOCIAL VARCHAR(255),
        NB_LGT_ACC_SOC_HORS_PTZ VARCHAR(255),
        NB_LGT_PTZ VARCHAR(255),
        SURF_HAB_AVANT VARCHAR(255),
        SURF_HAB_CREEE BIGINT,
        SURF_HAB_ISSUE_TRANSFO VARCHAR(255),
        SURF_HAB_DEMOLIE VARCHAR(255),
        SURF_HAB_TRANSFORMEE VARCHAR(255),
        SURF_LOC_AVANT VARCHAR(255),
        SURF_LOC_CREEE VARCHAR(255),
        SURF_LOC_ISSUE_TRANSFO VARCHAR(255),
        SURF_LOC_DEMOLIE VARCHAR(255),
        SURF_LOC_TRANSFORMEE VARCHAR(255),
        SURF_HEB_TRANSFORMEE VARCHAR(255),
        SURF_BUR_TRANSFORMEE VARCHAR(255),
        SURF_COM_TRANSFORMEE VARCHAR(255),
        SURF_ART_TRANSFORMEE VARCHAR(255),
        SURF_IND_TRANSFORMEE VARCHAR(255),
        SURF_AGR_TRANSFORMEE VARCHAR(255),
        SURF_ENT_TRANSFORMEE VARCHAR(255),
        SURF_PUB_TRANSFORMEE VARCHAR(255)
    ) AS pc
WHERE
    DATE_REELLE_AUTORISATION >= '2014-01-01' AND
    DATE_REELLE_AUTORISATION < '2017-01-01'